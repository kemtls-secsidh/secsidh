#include "fp-karatsuba.h"
#include "../fp-counters.h"
// #include "framework.h"
#include "../../primes.h"

#include <gmp.h>

//#define USE_GMP_SEC_FUNCTIONS
//#define MONTGOMERY

#if defined P2047m1l226

const fp p = {
0xFFFFFFFFFFFFFFFF,0xCB336E65DD9AB972,0x31DA9904076E6A70,0x9F825D7BEA428F54, 
0x80B1D7895DEABE60,0xD3B3CDE44A99EBD8,0x2C433638FE69F531,0x46C02600030671E2,
0x3EB36EBF24EB264F,0x5872FD3292CF3725,0x25261B882C99A891,0x5AA0C7A8E51C618F, 
0xDFE30228DC090A5E,0x1235FFF9C3496720,0x556D82DFB25A19E0,0xAF0D91A49AD1FCF6, 
0x5CFE8BDDCAAF7214,0x67D90F84820F3740,0x85DD61C29F9EA3FA,0x1B493E97510173BA, 
0x57963F8A2EF281C0,0x215B3CA607652A95,0xBE13D52039838268,0xC1B8B0AC479FC5EB, 
0xAACDDF254A1CEFF1,0x5D89B511362EE752,0x5C935F8B2C251C39,0x3336CCFC4DD81041, 
0xFE4AEA834B8F332,0x8AA77CDCE5CCA52,0x2DD1AFC034E7A378,0x4B5882EA64EA57E7 };
const fp p_minus_2 = {
0xFFFFFFFFFFFFFFFD,0xCB336E65DD9AB972,0x31DA9904076E6A70,0x9F825D7BEA428F54, 
0x80B1D7895DEABE60,0xD3B3CDE44A99EBD8,0x2C433638FE69F531,0x46C02600030671E2, 
0x3EB36EBF24EB264F,0x5872FD3292CF3725,0x25261B882C99A891,0x5AA0C7A8E51C618F, 
0xDFE30228DC090A5E,0x1235FFF9C3496720,0x556D82DFB25A19E0,0xAF0D91A49AD1FCF6, 
0x5CFE8BDDCAAF7214,0x67D90F84820F3740,0x85DD61C29F9EA3FA,0x1B493E97510173BA, 
0x57963F8A2EF281C0,0x215B3CA607652A95,0xBE13D52039838268,0xC1B8B0AC479FC5EB, 
0xAACDDF254A1CEFF1,0x5D89B511362EE752,0x5C935F8B2C251C39,0x3336CCFC4DD81041, 
0xFE4AEA834B8F332,0x8AA77CDCE5CCA52,0x2DD1AFC034E7A378,0x4B5882EA64EA57E7 };
const fp inv_min_p_mod_r = {
0x1,0xCB336E65DD9AB973,0xAF643763A21D419,0x9F2BDE02384F089B,
0xEEEE4E67E761E071,0xE14F6E448846FC16,0x7C33F1CB8995D537,0x9C5E5A0E41FBBB2B,
0x4018415AA62AB0F7,0x570A5C7C482D3FA4,0x290CBC45D2ED6704,0x6935DDB9DA0BF373, 
0xA9C3A7DCE054C2E7,0x1A92280608691985,0x786A946F6A893A4E,0x817444232C2B50DA, 
0x51BC998B9190158,0xED0A80A509441339,0x70CCCC137B5E8F1D,0x425869F7AD1DEB2C, 
0xE27606BD4F848CE,0xF78A71E7CFC37870,0x347E7689108AA61E,0xD89DFF0D518DFEFF, 
0x7223F57C599BD0D8,0xA84199D7B55177A2,0xBADC4BDDEB193D87,0x3C4583C1A5C1CD7, 
0x8ACB116EB508F9DF,0x23F88493636893F,0x47A93C3A24EFEA29,0x5420403EEAB4C43E };

#ifdef MONTGOMERY
const fp fp_1 = {
0x3,0x9E65B4CE672FD3A7,0x6A7034F3E9B4C0AD,0x2178E78C41385203,
0x7DEA7963E63FC4DE,0x84E4965320323C76,0x7B365D5504C2206A,0x2BBF8DFFF6ECAA59,
0x43E5B3C2913E8D12,0xF6A7086847925A90,0x908DAD677A33064B,0xF01DA90550AADB52, 
0x6056F9856BE4E0E4,0xC95E0012B623CA9D,0xFFB77760E8F1B25F,0xF2D74B122F8A091C, 
0xE9045C669FF1A9C1,0xC874D17279D25A3E,0x6E67DAB821241410,0xAE24443A0CFBA4D0, 
0xF93D416173287ABF,0x9BEE4A0DE9D0803F,0xC5C4809F537578C7,0xBAD5EDFB2920AE3C, 
0xFF96629021A9302A,0xE762E0CC5D734A07,0xEA45E15E7B90AB53,0x665B990B1677CF3B, 
0xD051F40761D52669,0xE600989694E9A109,0x768AF0BF61491597,0x1DF67740D140F84A };

#else
const fp fp_1 = {0x1};
#endif

#define pbits 2047
#define itch_size 128

#elif defined P4095m27l262
const fp p = {
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xBABB857F53B45F38, 
0xA0FA17C9F017AAA4,0xCA367EE9DCA136B3,0x9825FE450B3306F0,0x7598BC71B003BE60, 
0x75D9C93D2F88118F,0x25FAB108318489EF,0xB853C0B81A59A320,0xA68AC2FAA6576BD0, 
0x6FE6DE6B60B8DD73,0xBE1BA97A296DF474,0x90F3D594E0BB1B1A,0x50845534C663819,
0x5DA43F39BA465F9D,0x67A79C055011CD6C,0x10AABAC0E83F00E0,0x55B21EF174813BB, 
0xB32A5B550F65F8E8,0x6C8A637162557E06,0x184398D9CE7B8ED0,0xF6389D60A659DBF9, 
0x4898DDCC4C6451B1,0xD34D57E179DBAA87,0xB300098DDDD2A53D,0x4D83B4D248CD8DC8, 
0xA999042BBABBA293,0x8E37AAC3FD7145B5,0x896199C58C6CDEE2,0x5D499CA3173C69A1, 
0x324B4917CB3C3BFA,0xF83956A2F7A46669,0xE0CA5CB997EAFB95,0x16C0EB2AAF99D121, 
0xAF95A6D3DA6A40FF,0x8EDE5A2EF574F91F,0xF17F15465794272,0x411889A889DBBAF2};
const fp r_squared_mod_p = {
0xCA9664131ABC0203,0xBBACA9841048F533,0x8EABAAFDB1A5302C,0x8717BB74DAE9C8CC,
0xDB09FDAD266C9FE3,0x87FE292E7623BBAC,0xC4608F8CDD193747,0x29756590B837429E, 
0x25E069B05DF9158B,0x81B88A6E00EB97D7,0xFEB41576DF0529FE,0x75DCB5D79F31D7BD, 
0x4ECF835F54A00B39,0x12BDF9E28ADE3FA0,0xBE1FC6DF5625BA99,0x387429A496E48929, 
0x26C1594875AAEC54,0xF55991263DCDBF72,0x824598E7E40BF31C,0xCF0D0408B41080C8, 
0x6E8ED3548F1C53E3,0xE89C93835E6CB9A7,0xB8F73FC08D85EEAA,0x16813517F4D53663, 
0xBDABAD4E8AD094D7,0xC8F4E4BC812987AB,0xF2B12B6984FB1324,0xDCF1220EFBBDF5BF, 
0xD4ADE1120C73CECE,0xFF966A2C8A47A0CC,0x90B723888F342AB4,0xBBFFE44E9B103534, 
0x7A6882E784FAFFFD,0x2032BA8B44CD3D68,0xE59012732A0507CE,0x41030A597B14046D, 
0x70338B98F4FD3DF5,0xF9DBB4D3531E71A0,0xE09D4FD229D810B6,0x1F73C8F1FBBCF3F4, 
0xBDA5F434EDB6FD3B,0x138E4F816D09F0BE,0x4D29DC6B345CC58F,0x48365C1D1C10AD63, 
0x8799389318D2A8C2,0xDC983E5063104657,0x1BCDA74009C0B95A,0x46AC0180E7080A18, 
0x1ECE665A556B2D85,0xBE187F58C05BF423,0x137C3D745FCF8564,0xE94225E253BCC1FF, 
0xE18A90228B1C625E,0xED4C0E96616F842B,0x79EFB7D08707F5AF,0xB0FC6FF8828CCFD0, 
0x5459C35AFF8A0F53,0x55F5A04678F556B0,0xD8CBCC2A34884A9C,0xB64BC960DEA1137F, 
0x276AA6537115111B,0xE8F7B5C15A55D484,0x8CB566E62B90747C,0x2B202E35F35F4C36};
const fp p_minus_2 = {
0xFFFFFFFFFFFFFFFD,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xBABB857F53B45F38, 
0xA0FA17C9F017AAA4,0xCA367EE9DCA136B3,0x9825FE450B3306F0,0x7598BC71B003BE60, 
0x75D9C93D2F88118F,0x25FAB108318489EF,0xB853C0B81A59A320,0xA68AC2FAA6576BD0, 
0x6FE6DE6B60B8DD73,0xBE1BA97A296DF474,0x90F3D594E0BB1B1A,0x50845534C663819, 
0x5DA43F39BA465F9D,0x67A79C055011CD6C,0x10AABAC0E83F00E0,0x55B21EF174813BB, 
0xB32A5B550F65F8E8,0x6C8A637162557E06,0x184398D9CE7B8ED0,0xF6389D60A659DBF9, 
0x4898DDCC4C6451B1,0xD34D57E179DBAA87,0xB300098DDDD2A53D,0x4D83B4D248CD8DC8, 
0xA999042BBABBA293,0x8E37AAC3FD7145B5,0x896199C58C6CDEE2,0x5D499CA3173C69A1, 
0x324B4917CB3C3BFA,0xF83956A2F7A46669,0xE0CA5CB997EAFB95,0x16C0EB2AAF99D121, 
0xAF95A6D3DA6A40FF,0x8EDE5A2EF574F91F,0xF17F15465794272,0x411889A889DBBAF2};
const fp inv_min_p_mod_r = {
0x1,0x0,0x0,0x0,
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0xBABB857F53B45F39,
0xA0FA17C9F017AAA4,0xCA367EE9DCA136B3,0x9825FE450B3306F0,0x7598BC71B003BE60,
0x75D9C93D2F88118F,0x25FAB108318489EF,0xB853C0B81A59A320,0xA68AC2FAA6576BD0,
0x6FE6DE6B60B8DD73,0xBE1BA97A296DF474,0x90F3D594E0BB1B1A,0x50845534C663819, 
0x5DA43F39BA465F9D,0x67A79C055011CD6C,0x10AABAC0E83F00E0,0x55B21EF174813BB, 
0xB32A5B550F65F8E8,0x6C8A637162557E06,0x184398D9CE7B8ED0,0xF6389D60A659DBF9, 
0x4898DDCC4C6451B1,0xD34D57E179DBAA87,0xB300098DDDD2A53D,0x4D83B4D248CD8DC8,
0xA999042BBABBA293,0x8E37AAC3FD7145B5,0xDEDC3288E003993,0x28FCCC134500ED9, 
0x99237E427A9541FF,0x979318575D8DA63E,0xCD99020B3B318AB8,0xF038B83232D3D40A, 
0x8B6DB111DCEFF4B8,0x9204380C67BBB04,0x4DC7D4B3C7C3F798,0x76E2C34D5BDB8598};

#ifdef MONTGOMERY
const fp fp_1 = {
0x3,0x0,0x0,0x0,
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0x0, 
0x0,0x0,0x0,0xCFCD6F8204E2E255,
0x1D11B8A22FB90011,0xA15C83426A1C5BE5,0x378E0530DE66EB2D,0x9F35CAAAEFF4C4DE,
0x9E72A4487167CB51,0x8E0FECE76B726231,0xD704BDD7B0F3169F,0xC5FB7100CF9BC8D, 
0xB04B64BDDDD567A5,0xC5AD039183B622A2,0x4D247F415DCEAEAF,0xF0E730061ACD57B3, 
0xE7134252D12CE128,0xC9092BF00FCA97BA,0xCDFFCFBD4742FD5E,0xEFEE9A32BA27C4CE, 
0xE680EE00D1CE1547,0xBA60D5ABD8FF85EB,0xB7353572948D538E,0x1D5627DE0CF26C14, 
0x2635669B1AD30AEA,0x8617F85B926D006A,0xE6FFE35666881046,0x1774E189259756A5, 
0x334F37CCFCD1846,0x5558FFB407AC2EDF,0x63DB32AF5AB96358,0xE8232A16BA4AC31B, 
0x691E24B89E4B4C10,0x1753FC171912CCC4,0x5DA0E9D3383F0D3E,0xBBBD3E7FF1328C9A, 
0xF13F0B8470C13D02,0x5364F1731FA114A0,0xD2B82C02CF9438A8,0x3CB66306626CCF29};
#else
const fp fp_1 = {0x1};
#endif

#define pbits 4095
#define itch_size 256

#elif defined P5119m46l244
const fp p = {
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xB5309D1E99A64A6A,0xD4F20F3D310BE993, 
0xD92726C717015CFD,0xF06D7BAB9FBC61BA,0xC2EE5257F3F53C0A,0x3AF92D2E448901D2, 
0x3A0C8A8186EE6D0D,0x53C4B1599AEEC0E1,0xE4EACE2722BC33D6,0x238DC49B3B1C9CC, 
0xB8D14D0F82E0AFB5,0x3B1B2AB37CD1DF46,0x7B9D7D5D4927ED03,0xADC309FAFEB712E0, 
0x1E9A86229953557A,0x1F15A379F4EF9329,0xA65C5A1161E1D325,0xB8711C1B97A356D8, 
0x6AD52806F4121BE7,0x951B321B6C3C584C,0xD4EDED55AFC190E5,0x56CF35332848D386, 
0xF6322D985F4F8905,0x37E31D4DDBC39AD6,0xBCFFB1DE739D78F0,0xBFBF3DA580661DCC, 
0x5CFB6A9766C03723,0x1BAA906DE71522B6,0xD76E42C1E401FF20,0xA69EFCEFEF88BD2E, 
0xA0A2737A7E193839,0x68C24DC989220343,0x524C926C9F96C9CF,0x6B5ECF5EB8DE6C90};
const fp r_squared_mod_p = {
0x3BC209D061D6DD87, 0xC20E0B90609FABD3, 0x286D578E2C4FF785, 0xE206E52472A7EEDE, 
0x27B7686CD6D2AFCB, 0x3BC899CD6D5D88CE, 0xD28C794E2B4DAA33, 0x631A90FD5229E2C5, 
0x54454751FD39B108, 0x12FCE7E44304C25D, 0x1765308868FFD209, 0x46F09C4DDB2BAF90, 
0xCE3FD646557A4F3D, 0x5BD8E1F80E71D981, 0xEEA05877FC590324, 0xBB5D5F961018CFCB, 
0x9845271FE564D20D, 0xDD9F61C2CBD0C5C6, 0xB30D95539F4D2DD2, 0xF06DA81C0AF1D714, 
0x9F8A2D267CC95CC3, 0x69F88116DA07EE47, 0x911E83CA77B9FC8C, 0x70FE9A0FF36EC29, 
0x3B6858C6EA09FF39, 0xC0C1A01FC66553BF, 0xBF1C26B03D13448D, 0xCEE65529DB4276C6, 
0x263216DC529FA0E, 0x1064C4347BDEEE65, 0xE0A9109823C9039A, 0xADA812BBB0D2D2CE, 
0x58633B8D4B5C35BA, 0xDA399891C3CA96B0, 0xCB943DC5AD81966C, 0xE157868A016EAF8F, 
0x6993ABD64C6304CF, 0xE01D2BB15467A629, 0xFF811CCFF0BC9F26, 0x9EDC510CD20C3FEA, 
0xCF05F2DD5DF5214F, 0x7105AFC7967757B, 0x1E9AA04F82608BE6, 0x8CC448337DD40BB3, 
0x1E91E2EE0BA2628A, 0xE944B17DAA7E75A3, 0x9F88B4284AB2EF44, 0x655D7FC7AF0F8EF3, 
0x49941D534E88A774, 0xB8DA165FA2980B98, 0xB6277E3308F1352E, 0xB0F12FD49A72F8FB, 
0x196277406676BF1E, 0x87CEE5059AB1EB5C, 0xD2C05D44133E5806, 0x68566F0E45FE11ED, 
0x66DA8FDAF70DF18C, 0xC68F1FE501AF2D46, 0xDAAB9B14427818F3, 0xF1CB9BAC0E355F61, 
0xC0F17F8EBCA1009, 0xC27E77D6ED0276A8, 0x5B4D4E3A6E8C78F, 0xE612C67143BCCD2E, 
0x708D04B913FA3E7C, 0x555ED2D0C0CE68C8, 0x22FCADD05EA3CA69, 0x5C69744E6E5AE303, 
0x7DC7F9A803624B4A, 0xEF75C9D46AD3E933, 0x7F8514D0C288A3F2, 0x715F7F12FC09DAA0, 
0x101BBED10637E027, 0x1218366BDFCA08B3, 0xB66690544B7E2C72, 0xACA151A05BC36E67, 
0xF6498D4C167DD0D1, 0x9B68E87494DB23F, 0x56499A56DD8FF43A, 0x5DA4BF7B3B78AC38};
const fp p_minus_2 = {
0xFFFFFFFFFFFFFFFD,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xB5309D1E99A64A6A,0xD4F20F3D310BE993, 
0xD92726C717015CFD,0xF06D7BAB9FBC61BA,0xC2EE5257F3F53C0A,0x3AF92D2E448901D2,
0x3A0C8A8186EE6D0D,0x53C4B1599AEEC0E1,0xE4EACE2722BC33D6,0x238DC49B3B1C9CC, 
0xB8D14D0F82E0AFB5,0x3B1B2AB37CD1DF46,0x7B9D7D5D4927ED03,0xADC309FAFEB712E0, 
0x1E9A86229953557A,0x1F15A379F4EF9329,0xA65C5A1161E1D325,0xB8711C1B97A356D8,
0x6AD52806F4121BE7,0x951B321B6C3C584C,0xD4EDED55AFC190E5,0x56CF35332848D386, 
0xF6322D985F4F8905,0x37E31D4DDBC39AD6,0xBCFFB1DE739D78F0,0xBFBF3DA580661DCC, 
0x5CFB6A9766C03723,0x1BAA906DE71522B6,0xD76E42C1E401FF20,0xA69EFCEFEF88BD2E, 
0xA0A2737A7E193839,0x68C24DC989220343,0x524C926C9F96C9CF,0x6B5ECF5EB8DE6C90};
const fp inv_min_p_mod_r = {
0x1, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0xB5309D1E99A64A6B, 0xD4F20F3D310BE993, 
0xD92726C717015CFD, 0xF06D7BAB9FBC61BA, 0xC2EE5257F3F53C0A, 0x3AF92D2E448901D2, 
0x3A0C8A8186EE6D0D, 0x53C4B1599AEEC0E1, 0xE4EACE2722BC33D6, 0x238DC49B3B1C9CC, 
0xB8D14D0F82E0AFB5, 0x3B1B2AB37CD1DF46, 0x7B9D7D5D4927ED03, 0xADC309FAFEB712E0, 
0x1E9A86229953557A, 0x1F15A379F4EF9329, 0xA65C5A1161E1D325, 0xB8711C1B97A356D8, 
0x6AD52806F4121BE7, 0x951B321B6C3C584C, 0xD4EDED55AFC190E5, 0x56CF35332848D386, 
0xF6322D985F4F8905, 0x37E31D4DDBC39AD6, 0xBCFFB1DE739D78F0, 0xBFBF3DA580661DCC, 
0x5CFB6A9766C03723, 0x1BAA906DE71522B6, 0xD76E42C1E401FF20, 0xA69EFCEFEF88BD2E, 
0xA0A2737A7E193839, 0x68C24DC989220343, 0x524C926C9F96C9CF, 0x6B5ECF5EB8DE6C90};

#ifdef MONTGOMERY
const fp fp_1 = {
0x4C85DDB708AAB3B7, 0xE53539955D4E8885, 0x6B9905E19DFAEA80, 0x62C10074F683930D, 
0xEED50B07D25498B4, 0x87C293FB3817EE82, 0x69343068089E1C19, 0x59BDEEBDC3333EFE, 
0x2FA8C169CA201F65, 0x7D033C58225D01EE, 0x687A2907AF28D78A, 0x625F93179A60319C, 
0x2, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x5F8F7D732109FC83, 0x6C141457F7FB79EF, 
0x9F1E1124B46CCE6A, 0xD8621E92F0B80788, 0x7963C9F98FA91BFA, 0x40DE34B57134307A, 
0x710CAF0579BC605C, 0x57A5F43C443FEE57, 0xFEC7FB388FE0C6B, 0x4C63DC22E80D77B1, 
0x551D6294CE102367, 0x9190A3429B576C30, 0xC8D7D4075E08E561, 0xE6E597B96B5F1858, 
0x35315BC800C3D97F, 0x130FF29E314C89C1, 0x90B913753CDBAF2F, 0x64EFE24389263EDF, 
0x2D009B019B30F249, 0xD9DE771F7530DCB6, 0x3549471266D32E85, 0xEA1FA3AD765E3DCA, 
0xE7E3252BC32DCA59, 0xA7BCD605329717F0, 0x1F56A438ACEA670, 0x1CD806A1E99140D6, 
0xDE05B1711E916197, 0xDE54BE5F044E5B07, 0xB12DF7F1B776734, 0x35743279086E0842, 
0xBC65E52CFEF43FD0, 0xDD87A377F8C73A81, 0x8F5D235A8E660D63, 0x48F1B9991DC0A1CB};
#else
const fp fp_1 = {0x1};
#endif

#define pbits 5119
#define itch_size 322

#elif defined P6143m59l262
const fp p = {
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0x35985E4C03BD1014, 
0x74C88B0E3733AB9E,0xCC5EBC3CA4FAA947,0x821D23FC31769999,0x7DD81C7ECF287336, 
0x397B3BC1E4878A95,0x4668669E24F5CD05,0x45C68D7E8D5BA6E8,0x63DAA86AB6F4AA9E, 
0x4FEADF6BA95A3814,0xC14DC5EE6A02B1CD,0xCCAAB92DABD0F3E2,0x5C5DE133E486EA2A, 
0x149B3990755103CF,0x7E37E927A1F549AC,0xB41FA73F044C2191,0x1558E943308D9356, 
0xCC51A5F650F1DDE6,0x9CB2FD4B418C0807,0xFDAC42332803B31B,0x3FE7C77E1BD479FC, 
0x77B20071167346DE,0x63DA3A20500E6BE1,0xEBBB7C777054734A,0xA71872C190AEABFF, 
0xA13B14217BC25602,0x3BF5A900D843EEF1,0x2D83E22FC80D9EC1,0x3FAC5F1728799D3D, 
0x289BCF6DC62ADBCE,0x65606A37CBFD6BBA,0x4025C0EB0BD9BC24,0x316E981BB3081481, 
0xFFAE9D83F13FD711,0x3A4C4B7B7647853E,0x1D234B4CEA41F44B,0x5475A30084FF51D6};
const fp r_squared_mod_p = {
0x2BD64A1695D91221, 0xAB668F405D1F3AA6, 0x62C1DC395392B15E, 0x740A0EDE6F729D97, 
0xACCA9F0745EC07C4, 0x4D62DFF00BDF4E4A, 0x4F405F2298D5CA0, 0x6921189E05007224, 
0xA35C416904B61097, 0x9D904C400B8DCF37, 0x3FDFB59AE70D821F, 0xBD8CE300F01C879, 
0xB0380D40408D2917, 0xC1739E1D5F57E5DA, 0xE749F9F65C83F8B4, 0x4EFB02F443B9E391, 
0xC0ED58A103835CDD, 0x8E8F70510C7C4265, 0x620F482ED3447421, 0xF633C07F6C39998, 
0xFFA5469CF2AE3288, 0x1A3F623ECA347F5C, 0xD635012343FAE1C, 0xAE5CC273554F1B54, 
0x8A42AB5BDCAE1541, 0xF0D3B3047F8C08B5, 0x249884D7890DAB65, 0xA03D09994074DA1A, 
0x9C77F033074565E9, 0x3E6075B76D0CB457, 0xADA4045BE9805E5F, 0x4BFE221895D7BAAB, 
0x243D6436F4520BCF, 0x3FDC584EA1C137CB, 0x64B89A0F991D256C, 0x3040EFA4045BD3CD, 
0x574DF015EBB07469, 0x5A82419535A69173, 0x51B71ADE8370DE40, 0x63D6E90F7D40CF95, 
0xAA3BD1E6D6A5BA1C, 0x6DAF059FE5E7E671, 0x8A727CF14C3156DB, 0xBDEBB6CCCC37BFC3, 
0xEA1076E527DE13D2, 0xC52E0483E2754A2E, 0x5436E0A0C9B4B9B0, 0x36B05C5BE329B851, 
0x841BEB22660A7F99, 0xA41D5874CB9BB130, 0x14F7C9564D190F6D, 0x3D016994D56DC0D5, 
0x6FBC560206DCFC, 0x287A31B541B41B73, 0xD475ED64F68C23EF, 0x3AF40FB5B2217366, 
0x61B2DB68718CA1D8, 0xDE27B57ACF3EA0E9, 0x19539863C951FC69, 0x6C63EB7297A26001, 
0x720D5E481CB3C3E9, 0xC90A379C08518D75, 0x371DB311F64BAF8F, 0xEEF75B1227ECE52F, 
0xD3AE1D73D4B5F050, 0x6E0230BAD6EFAF73, 0x166A367619A9131A, 0x472CA66C65C1355C, 
0xB27214F6AA3F926A, 0xA65D408F9E6B8F4D, 0x5A007F285448F7EB, 0x145A0B70F9D990AB, 
0x94DA35D6C02464E6, 0xE99A19B5729A00F6, 0x384DFD750E9BCA1F, 0x2A33DF7EEF90AF96, 
0xBC4B300DB01C393E, 0xE13B96D4EA1D9F66, 0x9E6C032EDF283A8B, 0x5704BD129F0C3001, 
0xF4F58CB2C94A10CE, 0x6935099DC29CF109, 0x2D023E537E0EFE04, 0x269C93C842ACF6F5, 
0x7E3873C923EAC414, 0x7DF392EC1C615406, 0xBFF0365AF6B98F18, 0x341F4F5CE989504B, 
0x6D5407CB46526A3C, 0x7BE6CAF662658C1F, 0x2406F68919DB3ACB, 0xF128CD9AAC0DFC3A, 
0xBF7D8B09AD619BAF, 0x692C951825093507, 0x9F07881F3E0DCF56, 0x51FFF342D8EB5AB4};
const fp p_minus_2 = {
0xFFFFFFFFFFFFFFFD,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0x35985E4C03BD1014, 
0x74C88B0E3733AB9E,0xCC5EBC3CA4FAA947,0x821D23FC31769999,0x7DD81C7ECF287336, 
0x397B3BC1E4878A95,0x4668669E24F5CD05,0x45C68D7E8D5BA6E8,0x63DAA86AB6F4AA9E, 
0x4FEADF6BA95A3814,0xC14DC5EE6A02B1CD,0xCCAAB92DABD0F3E2,0x5C5DE133E486EA2A, 
0x149B3990755103CF,0x7E37E927A1F549AC,0xB41FA73F044C2191,0x1558E943308D9356, 
0xCC51A5F650F1DDE6,0x9CB2FD4B418C0807,0xFDAC42332803B31B,0x3FE7C77E1BD479FC, 
0x77B20071167346DE,0x63DA3A20500E6BE1,0xEBBB7C777054734A,0xA71872C190AEABFF, 
0xA13B14217BC25602,0x3BF5A900D843EEF1,0x2D83E22FC80D9EC1,0x3FAC5F1728799D3D, 
0x289BCF6DC62ADBCE,0x65606A37CBFD6BBA,0x4025C0EB0BD9BC24,0x316E981BB3081481, 
0xFFAE9D83F13FD711,0x3A4C4B7B7647853E,0x1D234B4CEA41F44B,0x5475A30084FF51D6};
const fp inv_min_p_mod_r = {
0x1, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x35985E4C03BD1015, 
0x74C88B0E3733AB9E, 0xCC5EBC3CA4FAA947, 0x821D23FC31769999, 0x7DD81C7ECF287336, 
0x397B3BC1E4878A95, 0x4668669E24F5CD05, 0x45C68D7E8D5BA6E8, 0x63DAA86AB6F4AA9E, 
0x4FEADF6BA95A3814, 0xC14DC5EE6A02B1CD, 0xCCAAB92DABD0F3E2, 0x5C5DE133E486EA2A, 
0x149B3990755103CF, 0x7E37E927A1F549AC, 0xB41FA73F044C2191, 0x1558E943308D9356, 
0xCC51A5F650F1DDE6, 0x9CB2FD4B418C0807, 0xFDAC42332803B31B, 0x3FE7C77E1BD479FC, 
0x77B20071167346DE, 0x63DA3A20500E6BE1, 0xEBBB7C777054734A, 0xA71872C190AEABFF, 
0xA13B14217BC25602, 0x3BF5A900D843EEF1, 0x2D83E22FC80D9EC1, 0x3FAC5F1728799D3D, 
0x289BCF6DC62ADBCE, 0x65606A37CBFD6BBA, 0x4025C0EB0BD9BC24, 0x316E981BB3081481, 
0xFFAE9D83F13FD711, 0x3A4C4B7B7647853E, 0x1D234B4CEA41F44B, 0x5475A30084FF51D6};

#ifdef MONTGOMERY
// R = 2**(2*E2*64)
const fp fp_1 = { 
0xD9726ADBE5EE05E5, 0x7479A3EB70E51E62, 0x7FEE16A06E683DDF, 0xC876A641BB8A3908, 
0x4BFEF0B507103A9E, 0x85F6806F819B9F4C, 0x37DFD0FE48B73126, 0x63983567135C2938, 
0x3506418AB064DA82, 0xEE5FF614BC49D9F3, 0xF921BB627032B734, 0x4AFBF385E42C1E3E, 
0xC14644CC4465EB02, 0x6452779CCABF7007, 0x24EFE2E8C5433459, 0xB0454C6026503B47, 
0x90BA2F0A429FBC96, 0x51E9113E4857BBDE, 0xF1EEF93F1D74FA65, 0x9B6219682A6EE10D, 
0x218D4197BF3094D7, 0x7F219423B82C979, 0x3, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0xF9191CCF3A0A3437, 
0x906B3F5C02F194FB, 0x18D408244CDCBCF7, 0xB1CCEEDC343AD4C7, 0xCBBB9E623353B5F8, 
0x6C47E088754321E0, 0x4B3C631CFC0B3F0C, 0x385139EFE24B4ED6, 0x2B72A3ACC540326B, 
0x6CAD0A499A3479EC, 0x9E163B0B56BA6635, 0xB706BA129DA23DC1, 0x3D17BA31F617BE46, 
0x7071A1920177DA37, 0xD1B064D71CAAEFB9, 0x4A1C93A5408B7023, 0x1541A539B828C12C, 
0x8B433B195C94C972, 0xDCFD3A593CDE9D62, 0x82B0C8BC24AC7324, 0x68D1280505C15E27, 
0x84C77FD6537BF5E6, 0xAB1A9594F4D3BE03, 0x3779F1893116C96C, 0xE77867D6CAE239CF, 
0xA9BFEFE2D3C6B60E, 0x91974C09544535F9, 0x6AAE83631115044E, 0x23A3C75D4B7B6B6A, 
0x49AB41D5AB3365D4, 0x766FA7B967E2E45, 0xEB19B59D4810B7E8, 0x43EF678F03D8F274, 
0xF8C3B138BAD8FE60, 0x5B46800B08639054, 0xC896A9232AEEDB03, 0x4FAF5030389F3BAF};

#else
const fp fp_1 = {0x1};
#endif

#define pbits 6143
#define itch_size 386

#elif defined P8191m78l338
const fp p = {
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,  0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0x3EAF65A95F0041EC,0x372B7D9154133882, 
0x5A58A580E1CA9829,0x8FC4156DDCAD437,0x4CE6AE3C63765131,0x4F3865F90F46D0D3, 
0xB6AA2C454C34E51B,0xD434D3F80A147B77,0x6B926F74A2AA5C76,0x43BCB530BDFEAFF9, 
0x671D6CE9572B43C1,0xD5B30D80ECB73020,0xF823265621739F49,0xC1754744306061CA, 
0x6171E42D89E177BB,0x8994F48EF23A7F2A,0xA2057C82B399C3AF,0xC60CD8BEC9D528B1, 
0xB9B5FAB739469676,0x601A2E4779AEC853,0xE00D857E16B58377,0xE65DEF66D0C08A1D, 
0x26692BC11E11E82B,0x3A2B8F6CD365560D,0x39E653855729C7FB,0xC10B3B5E0D9DE1C4, 
0x7D13530314EEC59E,0xD0A1B556BFEAF779,0xE63C16F48D4938B9,0x3839DF74876C52B0, 
0x5AD0EACB1BD7283,0xC1709D8F85717F0F,0x185BC2F57DE71EB1,0x2F9EC8170F78D4E0, 
0xF519D562D85DB142,0x9CCB77F2238053C5,0x6BB5CF773506E8B0,0x2770E39BEED00FEB, 
0x3A51E0099D663BC,0x5E93F3908FA8986E,0x4AE63438608085B,0x5290F3FDF0F9F666, 
0xA5E5B7F7D86B7F44,0xAB4BD70919AC3458,0x60473AD832847641,0xC35589BD7E5B6D68, 
0x60340C810D6E6475,0xDA4E9331BBBE84E,0x8726969D65FA39A0,0x558064826AE53F6C};
const fp r_squared_mod_p = {
0x6EF47978C6660758, 0x71CC90B5BF9BA10C, 0x1D437FEC7652624F, 0x1854A066A0B8E641, 
0x6BF266E5EF792C82, 0xF5001A496EA03D4B, 0x2EA5CBB8433F388A, 0xC195E39C631D240A, 
0x61D5B0B9A1609513, 0xF69ECABA5A22D23F, 0x6EFEB481B8C58DB3, 0x78913661F1C4C013, 
0x6A0C1013CB765ED3, 0x8A7AB55A09FCF236, 0x97144156FE4C8008, 0x9EC09FFC816F8B0E, 
0xA85FC38537D02D27, 0x342D1096D53B2292, 0xC38F5FE55DBFB29C, 0x68EF7AEC91FAD217, 
0x1F6C71CDA340EFCC, 0x8AFCDB9DED22A970, 0x8B57B3B0F8E17469, 0x8E2627135A91D7E2, 
0xEDF4A63094068ADC, 0x259AD011E3594E26, 0x920FB9D0CCB81F4F, 0xC1154EA5C52887A0, 
0x54F5C40400AE1009, 0xC525053A75A0CFDA, 0x75B4FB36A22C4F06, 0xD2EDB65DD94E1137, 
0x422B06003EFF64CA, 0x36769C9D1D3D49E, 0xDDFFB9390BB1FEF5, 0xF45EDF826B072F65, 
0x354470F9AD091AC2, 0x857C9830A0B8CFF2, 0x9E23A3972040D4BC, 0x2D46EAA99038BD5A, 
0x3BFDB88BC868395F, 0x5B1A856ACCC71B25, 0xAF3A2B53C5552151, 0x4B495E58DEB22E76, 
0x251065A49CDA42C3, 0x51ABC4E6865862B4, 0xF5A3E5D3A28E1200, 0x87D832508C72A06D, 
0xF480F97924A2A68F, 0xCB8B8EADFC8B7D75, 0x8317F55A68E25D4B, 0x1F1CD0705ABCE0F1, 
0x3EC42BF7FD922423, 0xBEB8591FF495C1F5, 0x3BAC54C9A7B7B548, 0xB1D089A697B7FEAC, 
0x48FF50537902DF76, 0xC2BEB8EDB7A746B, 0xB191B393624EDDC9, 0x5FDA25C18B693E94, 
0x8EC0B349149054A6, 0xFEB68765452E6B6A, 0x997E5330C0C214A4, 0x3A15A96F06078DA8, 
0x114440E55C5C16E3, 0x657C50D8C556322A, 0x8D824EF35CC9B18D, 0x62FAFDB9455B9877, 
0xBE7240C977BCF4C, 0x428F91F09E626C35, 0xB3AD14DCFEA6FE33, 0x71D3C4CA016B49C9, 
0x7A6507B9299BDEAC, 0x7B173AD40A91FC44, 0x62BB05E87C5FD442, 0x246BFD096A84F103, 
0x52426D6B9D8D47A0, 0xE4BB917FB1C2191A, 0xAFFB9F9364EA6E53, 0x45EE9A0D35E5F70F, 
0x89D03020F464678B, 0x7205D5F0D92AB378, 0x210DF74401655CDE, 0x3349A0834D1BBDD3, 
0x26D3477AFE928BBA, 0xD1137A473E242E2, 0xC75EB17B0A3CFAAC, 0x31A07D7A37FE7E03, 
0xE2330C6A41D785CC, 0xC5DF0A51E4A81DA0, 0xA8911B4FAB7ADADC, 0x957681FFC22B1BFF, 
0xC2BC546BA637CB2, 0x5AA678506F358386, 0x3615C53EE1B9B731, 0x4990CABCFE1D0F65, 
0x766FBDFEBB3ADBA5, 0x97B8F83C9727DFF4, 0x422E1F813EDEE0D8, 0xBB65AE04BA82578F, 
0xC7469607621B54AC, 0x46F7671F0FC949FF, 0xB7A56C2B43BC33EC, 0x7B415A6944CD887A, 
0xBE085B882D0A29E2, 0x71EF6D5C2606B2A6, 0xA71FC964F9606701, 0x2BB88D21A09C80E8, 
0x5D42FB23A6D7AFDA, 0x1A489AE968B53EA4, 0xD721AB3F0040919, 0x552544D479D82CAB, 
0x38CB733B33024ED7, 0xE43FDE60C6C1CA50, 0x9B2E7BA1A18CA3A1, 0x47EC62B3DA8EE941, 
0x6F818A595A9657A9, 0xF2EFDB0ED88378D8, 0x7EB2DB000D0A4964, 0x17C03A50E82C84C6, 
0x7E1EE27314721BDE, 0x8696D45E8264EA43, 0x5A2B249DE1AB808F, 0xF46532B0949AA8D4, 
0x7B0EF80603EF387F, 0x1D4E2CAF575F6E5D, 0x6E046D5101EA9A2B, 0x393856558D343339};
const fp p_minus_2 = {
0xFFFFFFFFFFFFFFFD,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0x3EAF65A95F0041EC,0x372B7D9154133882, 
0x5A58A580E1CA9829,0x8FC4156DDCAD437,0x4CE6AE3C63765131,0x4F3865F90F46D0D3, 
0xB6AA2C454C34E51B,0xD434D3F80A147B77,0x6B926F74A2AA5C76,0x43BCB530BDFEAFF9, 
0x671D6CE9572B43C1,0xD5B30D80ECB73020,0xF823265621739F49,0xC1754744306061CA, 
0x6171E42D89E177BB,0x8994F48EF23A7F2A,0xA2057C82B399C3AF,0xC60CD8BEC9D528B1, 
0xB9B5FAB739469676,0x601A2E4779AEC853,0xE00D857E16B58377,0xE65DEF66D0C08A1D, 
0x26692BC11E11E82B,0x3A2B8F6CD365560D,0x39E653855729C7FB,0xC10B3B5E0D9DE1C4, 
0x7D13530314EEC59E,0xD0A1B556BFEAF779,0xE63C16F48D4938B9,0x3839DF74876C52B0, 
0x5AD0EACB1BD7283,0xC1709D8F85717F0F,0x185BC2F57DE71EB1,0x2F9EC8170F78D4E0, 
0xF519D562D85DB142,0x9CCB77F2238053C5,0x6BB5CF773506E8B0,0x2770E39BEED00FEB, 
0x3A51E0099D663BC,0x5E93F3908FA8986E,0x4AE63438608085B,0x5290F3FDF0F9F666, 
0xA5E5B7F7D86B7F44,0xAB4BD70919AC3458,0x60473AD832847641,0xC35589BD7E5B6D68, 
0x60340C810D6E6475,0xDA4E9331BBBE84E,0x8726969D65FA39A0,0x558064826AE53F6C};
const fp inv_min_p_mod_r = {
0x1, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x0, 0x0,
0x0, 0x0, 0x3EAF65A95F0041ED, 0x372B7D9154133882,
0x5A58A580E1CA9829, 0x8FC4156DDCAD437, 0x4CE6AE3C63765131, 0x4F3865F90F46D0D3,
0xB6AA2C454C34E51B, 0xD434D3F80A147B77, 0x6B926F74A2AA5C76, 0x43BCB530BDFEAFF9,
0x671D6CE9572B43C1, 0xD5B30D80ECB73020, 0xF823265621739F49, 0xC1754744306061CA,
0x6171E42D89E177BB, 0x8994F48EF23A7F2A, 0xA2057C82B399C3AF, 0xC60CD8BEC9D528B1,
0xB9B5FAB739469676, 0x601A2E4779AEC853, 0xE00D857E16B58377, 0xE65DEF66D0C08A1D,
0x26692BC11E11E82B, 0x3A2B8F6CD365560D, 0x39E653855729C7FB, 0xC10B3B5E0D9DE1C4,
0x7D13530314EEC59E, 0xD0A1B556BFEAF779, 0xE63C16F48D4938B9, 0x3839DF74876C52B0,
0x5AD0EACB1BD7283, 0xC1709D8F85717F0F, 0x185BC2F57DE71EB1, 0x2F9EC8170F78D4E0,
0xF519D562D85DB142, 0x9CCB77F2238053C5, 0x6BB5CF773506E8B0, 0x2770E39BEED00FEB,
0x3A51E0099D663BC, 0x5E93F3908FA8986E, 0x4AE63438608085B, 0x5290F3FDF0F9F666,
0xA5E5B7F7D86B7F44, 0xAB4BD70919AC3458, 0x60473AD832847641, 0xC35589BD7E5B6D68,
0x60340C810D6E6475, 0xDA4E9331BBBE84E, 0x8726969D65FA39A0, 0x558064826AE53F6C};

#ifdef MONTGOMERY
const fp fp_1 = {
0xF16D5AB42ABA8F78, 0xC066A9902C8994AE, 0x217375714EEFB482, 0xB8F320360956BD6E, 
0xB1EACDCCA4AA7069, 0xDDDAF2AFC4E2168E, 0x2EBB27821CE15FCC, 0x141129EB681FD585, 
0x8C774CDD1A95D702, 0x3BB6EC5C2422D655, 0xE3CC8FD8F490E9A7, 0x986CB4D888CB10AD, 
0xFB46B56714640555, 0xAB859E40A701554E, 0xE2CAD2D843B952DD, 0xC522F9570A3B65B5, 
0x208FB48234FAD34E, 0x7AD60E842797F564, 0x82A482EA2D850D95, 0x3006F09C6ADF3079, 
0x4A92C57F214FAB94, 0x843C344B5206FC59, 0x405072F30230A7CF, 0x9DD9691342730029, 
0x9B5327190D04AEA3, 0xFF8F8662734492C7, 0x85D8F15B4C40F73F, 0xFE7D3A948226EB40, 
0x2, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0xEB14FEE58ADBB5E8, 0x132FF2DA38C5E511, 
0x47275F4AAAD3998D, 0x10810FBBA10F9CE5, 0xDCFBD2D1938F656A, 0x35B628F5E8832AC6, 
0x4B61B8F8967A52DE, 0x64F008DF9CAE57A2, 0x2E3778A63E823882, 0xF99338FBC6853076, 
0xF5684EFF23A6591D, 0x309CA32F3A87A458, 0xBA4B0CE0CFDC974, 0x2F49D5EC1CD98601, 
0xA32B516A2297E017, 0xEB89723DDA492E71, 0x708DFC9920B09B14, 0x83CE24EBC4DC2F9F, 
0x1160647685C70B75, 0x8BBD2A8F0E98B18D, 0xB63A21BD411C55EB, 0xF076268E96148BCA, 
0xFEF68177B18FCFFD, 0x94F91BF0D3A50E97, 0x3E183E998545BE5D, 0x48898DBAE2F464FC, 
0xD150EFDEF190D8ED, 0xD20DAEA90FC5FECA, 0x89B17FE9DDCD8F6C, 0x563BD8AA03A46271, 
0xF0BCCD99267907AE, 0x505F9EC2B338E919, 0x42636D0D92946444, 0x2CA1411356D9FF7D, 
0x7DB82C588239A8C5, 0x1FBE398BEB9DD213, 0xDF0272A3BD3DFA2C, 0x2DBDE14FB98DF7BB, 
0x581ACDBBADFDBA6D, 0x6BA5B1E0BC8C2176, 0x38C76529F69680E9, 0xA3472F69F1A6B3A9, 
0x2A1995B50753A828, 0x4515A62AF4C3B515, 0x74E8ABF6A01C03D0, 0x191358DC40EEE56A, 
0x85C4DFE4273AC5B9, 0xCBB13E3EB58B3B9D, 0x17373701F5357F3E, 0x294F447DCBC6C965};
#else
const fp fp_1 = {0x1};
#endif

#define pbits 8191
#define itch_size 516

#elif defined P9215m85l389
const fp p = {
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xD4EB2E32201FF538,0x9731F6B12064E278,0x68F5236C9A6E8EEB, 
0x6FF70217C7682DD9,0xD996C5CAFCAB6BA6,0xEE5EF78FD74361DB,0x3BA7F52C9AA6F698, 
0xC9BEDE007C259BF0,0xD9A864CC7D33B52C,0x440F7936394BF5B6,0xCF4B1FD62F49C859, 
0x92D044003F20EADC,0xCD842B3809D80C8E,0x2FBDB1D89B9D569F,0x613F115278C53010, 
0xB95DE73343F27240,0xC92888276CA27909,0x28839A94D3CA2D5F,0x93147941B2E308, 
0x745BCF59034C79D5,0x73C37E1E3AE8FC67,0x2E9DE986D4FC8646,0x33859631C10023B1, 
0x15A2A2E2188C4BEC,0xBF8F6740D0BAE643,0x42FEB9CCCF7D3200,0x792C49D34520B80E, 
0x83959EC2A5E959BB,0xF6BB457B67E4747,0xCC1CA65F453F0CE5,0xCD0FC61342EC7176, 
0x45FA3489D307DC18,0xDA7FA26690C6E0F6,0x144DB37F4D0B736D,0x2F53EAEDABBEB338, 
0xA7015C360AFA08C0,0x282F93BFA396C390,0x701BE8C44F787FAD,0x5530DBBAB892409E, 
0x36E5E81E4162EAEE,0xBB332AD4236A07AD,0x3276B28E0577E3F1,0xA973F305069CC11E, 
0xDDD71DAAC305A437,0x21B47A8072B86EAE,0x799455FDCD01F2FF,0xFF4E3D96380C1004, 
0x3AF56DDA678BFF86,0xA882C926E07337F9,0xEB2143236B97EBF1,0x3A70A1E85E02F35A, 
0x49BDF004F95AC7F6,0x380D448104A8EB09,0x704E29C40AB77B69,0x199F2E3A6D2E23AC, 
0xA5252A0EFC013C8C,0x38CABDE8DD5935A4,0x57DEA1BECC1C7D9A,0x71A72AD537EA0C9E};

const fp r_squared_mod_p = {
0xD628E7A8CF36F86D, 0x538E846C644D4FF3, 0xBFD10CA832198F76, 0xD19E8FF4B8FB9A5C, 
0x834D3D4B39EEBD8B, 0xFC05ACF2586373A4, 0x28A60CBBCDB5DB6, 0x6AA1C069DAAB2BCA, 
0xEF0698062A0BDD58, 0x3DA6E81A3F0E4B6A, 0x765853E149D2B7E1, 0x2F07B6D0704CB99A, 
0x8D42E5B90BE0A307, 0x6674DD12E823FFB1, 0xAFF599671C9503AE, 0xED5B6AA194B12E84, 
0x8FA052A257612D39, 0x9D8A7BFF0E1BFEC7, 0x8062A6F5E1D6849E, 0x6E66CF3B24298A86, 
0x66D194BCFC9DF851, 0x6582BC7E83349D97, 0x4DD5D089616A6B8B, 0xC53E0740DA09251, 
0x4ACCE328A2C4EABA, 0xA02D51D0D7272F0A, 0xC1FC0635D973418A, 0xC698A8FE0B5B9107, 
0x4DA330D9B5AF336A, 0xF561405FBCC421C0, 0xF1E8D9DDFC6AF31C, 0xED6FF5FDB519F98B, 
0x9263B86FE42E768E, 0xFBE6D62C9411CB27, 0xF39EA410720AE2C7, 0x471C0E08DC2DD16D, 
0xA001E9CAF99DA797, 0x8D045B661264E95E, 0x5E0567BBF9A6FC69, 0xA306A293F9258849, 
0x28EEEB250C86E29A, 0xF12162E0398E00B7, 0xA470E56CC3A69695, 0xAE9B27FD8C02D230, 
0x1E44BC1175173651, 0x7F182FB786F56EDA, 0x40BEB2A6987D9F21, 0x8D2BC8D61F410D75, 
0xDE29464D05CBE557, 0x2ABE940E12A17075, 0xE45DBC675BC86B9E, 0x5CBFDB3FA5E3E0F3, 
0xA9AF7454F03D753C, 0xFEE65A88EB10B5EA, 0x4980B568F42EF7C1, 0xB9D6862C549712E1, 
0xF4239DA640C945A8, 0x84EE9556F038099A, 0x9CCA409764812D51, 0xB8EDDA69575EE654, 
0x150EBAF6B58EABD7, 0x392BB3D9715CA58, 0x202D9EEF0B9F5FC2, 0x38847E9AAD3A47B5, 
0x51284A9012387F18, 0xCDDEC9C363F777FE, 0x1FBB90D81871E7A7, 0x1688191F2B2EC4F8, 
0xFFEB61B2BEA7F4A3, 0x73E922B23B71CDEC, 0xDE544F4141AAE2FC, 0xF90F8873A82100DA, 
0x613C7FF306B3AF8D, 0x29D174286C1B2CDA, 0x35E90A4395B92C78, 0x2B2D6281513FC944, 
0xADF9F91549E9746C, 0x3E0465589E71470, 0x8B7B897823DC3A6A, 0x74A3C4C0D12846FB, 
0xAD92B4AB385A3DB3, 0xA3930061C92CFA0E, 0x5F781937AE64D117, 0x82C6215777B68905, 
0xDEF3C3145BC7B2F1, 0xE25B1AA9DAED6FEA, 0xC7672232B5DD2E3F, 0x6E5006F24B5C8CD8, 
0x6CA2FA9523201CA, 0x4F3E62173D085F11, 0x9B82786519184421, 0xECB1B92DAAC65DB2, 
0x76AE069C491FFFB0, 0xA8F1D40BCD396FA3, 0x7810D35B3A0EB764, 0x2CF42034AB0ED82D, 
0xBFAF0D2FA9B02F66, 0x396B180C7A6AAB16, 0x53EFED2DB5BBB416, 0x47841EB7E25023EB, 
0xA0CD764E411FC34B, 0x3EAA5C017AAB92BB, 0xC34257424D00BA32, 0x37B6CA9FF5BD6F2D, 
0x19C3E33F48ACC867, 0x5303B8BC65F285F2, 0x81D659DB3561D47E, 0xAACD72CEBC44820, 
0x146254B95E1A9670, 0x4BD6C4BE021DB60C, 0xE92C990D1E0E0CA4, 0xECB25F4910932A2E, 
0x297F5C6C20EB06CC, 0x5298D7158FABA0A5, 0x1748774210C58B7A, 0x49C9C5D808F551AE, 
0xC316A70654971EDA, 0x14CB36AE20CA1A85, 0x205070551F5EB61E, 0x6AE9290A7866B3ED, 
0x54287505BDAD280C, 0x9607260E2030D868, 0x5AE9EB6BCFD5828B, 0xDB456FE560A4B8AA, 
0xB659BE66AD2160DB, 0x63B452C152C6D679, 0x3F36C53DF6D047F2, 0x26C35AA3731AEE9E, 
0xB2B988A83B319A64, 0x8175091B5B6E0B4A, 0xD0725F729EC48504, 0xD68F57600E1B94E6, 
0x541C023E686BC25A, 0x25CECA6F63B88166, 0xD22F482DAF747752, 0x1DB6B96BF01BF9D2, 
0x31D22273C61FB4C6, 0x170D6BF281AB11DB, 0x44439BF28111A70B, 0xD7D01AE531A90D0, 
0x43F4F3B184471D00, 0xA1E2251357C01A17, 0xAE401F1CD6F1409B, 0x6DFC92DC7ABEA603};

const fp p_minus_2 = {
0xFFFFFFFFFFFFFFFD,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF,0xFFFFFFFFFFFFFFFF, 
0xFFFFFFFFFFFFFFFF,0xD4EB2E32201FF538,0x9731F6B12064E278,0x68F5236C9A6E8EEB, 
0x6FF70217C7682DD9,0xD996C5CAFCAB6BA6,0xEE5EF78FD74361DB,0x3BA7F52C9AA6F698, 
0xC9BEDE007C259BF0,0xD9A864CC7D33B52C,0x440F7936394BF5B6,0xCF4B1FD62F49C859, 
0x92D044003F20EADC,0xCD842B3809D80C8E,0x2FBDB1D89B9D569F,0x613F115278C53010, 
0xB95DE73343F27240,0xC92888276CA27909,0x28839A94D3CA2D5F,0x93147941B2E308, 
0x745BCF59034C79D5,0x73C37E1E3AE8FC67,0x2E9DE986D4FC8646,0x33859631C10023B1, 
0x15A2A2E2188C4BEC,0xBF8F6740D0BAE643,0x42FEB9CCCF7D3200,0x792C49D34520B80E, 
0x83959EC2A5E959BB,0xF6BB457B67E4747,0xCC1CA65F453F0CE5,0xCD0FC61342EC7176, 
0x45FA3489D307DC18,0xDA7FA26690C6E0F6,0x144DB37F4D0B736D,0x2F53EAEDABBEB338, 
0xA7015C360AFA08C0,0x282F93BFA396C390,0x701BE8C44F787FAD,0x5530DBBAB892409E, 
0x36E5E81E4162EAEE,0xBB332AD4236A07AD,0x3276B28E0577E3F1,0xA973F305069CC11E, 
0xDDD71DAAC305A437,0x21B47A8072B86EAE,0x799455FDCD01F2FF,0xFF4E3D96380C1004, 
0x3AF56DDA678BFF86,0xA882C926E07337F9,0xEB2143236B97EBF1,0x3A70A1E85E02F35A, 
0x49BDF004F95AC7F6,0x380D448104A8EB09,0x704E29C40AB77B69,0x199F2E3A6D2E23AC, 
0xA5252A0EFC013C8C,0x38CABDE8DD5935A4,0x57DEA1BECC1C7D9A,0x71A72AD537EA0C9E};

const fp inv_min_p_mod_r = {
0x1, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0xD4EB2E32201FF539, 0x9731F6B12064E278, 0x68F5236C9A6E8EEB, 
0x6FF70217C7682DD9, 0xD996C5CAFCAB6BA6, 0xEE5EF78FD74361DB, 0x3BA7F52C9AA6F698, 
0xC9BEDE007C259BF0, 0xD9A864CC7D33B52C, 0x440F7936394BF5B6, 0xCF4B1FD62F49C859, 
0x92D044003F20EADC, 0xCD842B3809D80C8E, 0x2FBDB1D89B9D569F, 0x613F115278C53010, 
0xB95DE73343F27240, 0xC92888276CA27909, 0x28839A94D3CA2D5F, 0x93147941B2E308, 
0x745BCF59034C79D5, 0x73C37E1E3AE8FC67, 0x2E9DE986D4FC8646, 0x33859631C10023B1, 
0x15A2A2E2188C4BEC, 0xBF8F6740D0BAE643, 0x42FEB9CCCF7D3200, 0x792C49D34520B80E, 
0x83959EC2A5E959BB, 0xF6BB457B67E4747, 0xCC1CA65F453F0CE5, 0xCD0FC61342EC7176, 
0x45FA3489D307DC18, 0xDA7FA26690C6E0F6, 0x144DB37F4D0B736D, 0x2F53EAEDABBEB338, 
0xA7015C360AFA08C0, 0x282F93BFA396C390, 0x701BE8C44F787FAD, 0x5530DBBAB892409E, 
0x36E5E81E4162EAEE, 0xBB332AD4236A07AD, 0x3276B28E0577E3F1, 0xA973F305069CC11E, 
0xDDD71DAAC305A437, 0x21B47A8072B86EAE, 0x799455FDCD01F2FF, 0xFF4E3D96380C1004, 
0x3AF56DDA678BFF86, 0xA882C926E07337F9, 0xEB2143236B97EBF1, 0x3A70A1E85E02F35A, 
0x49BDF004F95AC7F6, 0x380D448104A8EB09, 0x704E29C40AB77B69, 0x199F2E3A6D2E23AC, 
0xA5252A0EFC013C8C, 0x38CABDE8DD5935A4, 0x57DEA1BECC1C7D9A, 0x71A72AD537EA0C9E};

#ifdef MONTGOMERY
const fp fp_1 = {
0x35571B3041B59ED6, 0x77513D2C8359F0B9, 0x2A4EF7A69C83834B, 0x42127C9C01D62F96, 
0x63C9962A19A5792F, 0x2D44706D77E2CF66, 0x5CCC6D9AD8938403, 0x4B9045856C05DABB, 
0x1675CBD1DA1A0E97, 0xFB8CDC8B835068ED, 0xA31B35F80A2BF2FD, 0x2B3F9A34D47A60EB, 
0x1B9185F1FDF3AE3F, 0xAA2C1459CA7AD5A3, 0x38F8D274F62FE2AC, 0xD868DA770B10AC69, 
0x6635DDE65B5C329E, 0xC2DD90A8DDFAB59E, 0x9FCA46596630853, 0x4F0CE6521038398B, 
0xAA5DECE42917E70F, 0xF0F3BC2945CC9EEE, 0xF580BE67B4FC33A8, 0xEB8364A69097978D, 
0xB121746EF5CE1876, 0x40A1E49C67CCE64A, 0x2, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0x0, 0x0, 0x0, 
0x0, 0xF111A0B991A2D45A, 0x677C0EC673EFB8F6, 0xCD8BFFAD95B37B94, 
0x584597A4BE0197AC, 0xC48916EF1784DB77, 0xA5CACE04FFF9E68F, 0xD82AF1915332F04C, 
0x78ADB9616DD63517, 0xC4A1F648CCE5F28F, 0xF689FCB00224C0D3, 0x39E61D3DD443C683, 
0x3BA0A2ECBC17669F, 0xE51E7F891F9FE18F, 0x4B902A8AA6C816EF, 0x151592A86846876E, 
0x9ED7B60179AF1FF0, 0xDC8564A497737D28, 0x8E64F1E0629E2603, 0xC7C25AEEABA316FF, 
0xBD096DABCF86E041, 0x9CFE91E87ECD2587, 0x7817747B413A10B2, 0xBA52FC750F906A76, 
0xBF466889CE09B0F7, 0x2220A439EF790767, 0x478A16786E3075E4, 0x95BF2E7AF866E3B6, 
0x57999F311560ABA3, 0xE9815021A39FAD9, 0xDA77874780768212, 0x7F556E9CFCECC1D8, 
0xD4C9749EE79BC3A0, 0xA622C7977F85891B, 0x65890AEE7147A667, 0xBC58002B61DFAF28, 
0x15B651D2C27DD4F4, 0xCBEA60030CB9557C, 0xBC3C60417C38EDC2, 0x53228A1492BEAE08, 
0xC0CDDF0A245E40CD, 0xE17FFCF7C1AE4017, 0x1F66010ACF029028, 0x8289F77710C1F724, 
0x41AE447C0F87CC1A, 0x5B4B13C51EFF1380, 0x4028487B1948F545, 0xD068746D116FAC6A, 
0x698806EB84540437, 0xFEC9CB3FA06AF4C8, 0x41B517FA3154CF93, 0xCC499D7388094FA9, 
0x6DBED75BB1835F6B, 0x651BF6A6E3CD3D0C, 0xB74B05B3A54B229A, 0xA5C9E093DE2BF659, 
0xA4E68EA418EEC689, 0xE269F0E7DA8A659D, 0x3FB906320F66A16B, 0x41E8B6E3025D1436};
#else
const fp fp_1 = {0x1};
#endif
#define pbits 9215
#define itch_size 578

#endif

const fp fp_0 = {0x0};

void fp_pow(fp b, const fp e, const fp a)
{
    (void) a;
    (void) b;
    (void) e;
}

/*
    see Algorithm 14.36 "Montgomery multiplication"
    https://cacr.uwaterloo.ca/hac/about/chap14.pdf
*/
void fp_mul(fp c, const fp a, const fp b)
{
#if defined(P2047m1l226)
    uint64_t result[64];
    fp_mult_32x32(result, a, b);
    fp_word_redc(c, result);
#elif defined(P4095m27l262)
    uint64_t result[128];
    fp_mult_64x64(result, a, b);
    fp_word_redc(c, result);
#elif defined(P5119m46l244)   
    uint64_t result[160];
    fp_mult_80x80(result, a, b);
    fp_mont_it_redc(c, result);
#elif defined(P6143m59l262)
    uint64_t result[192];
    fp_mult_96x96(result, a, b);
    fp_mont_it_redc(c, result);
#elif defined(P8191m78l338)
    uint64_t result[256];
    fp_mult_128x128(result, a, b);
    fp_mont_it_redc(c, result);
#elif defined(P9215m85l389)
    uint64_t result[288];
    fp_mult_144x144(result, a, b);
    fp_mont_it_redc(c, result);    
#endif
    CNT_FP_MUL_INC();
}

void fp_sqr(fp b, const fp a)
{
#if defined(P2047m1l226)
    uint64_t result[64];
    fp_squaring(result, a, a);
    fp_word_redc(b, result);
#elif defined(P4095m27l262)
    uint64_t result[128];
    fp_squaring(result, a, a);
    fp_word_redc(b, result);
#elif defined(P5119m46l244)   
    uint64_t result[160];
    fp_squaring(result, a, a);
    fp_mont_it_redc(b, result);
#elif defined(P6143m59l262)
    uint64_t result[192];
    fp_squaring(result, a, a);
    fp_mont_it_redc(b, result);
#elif defined(P8191m78l338)
    uint64_t result[256];
    fp_squaring(result, a, a);
    fp_mont_it_redc(b, result);
#elif defined(P9215m85l389)
    uint64_t result[288];
    fp_squaring(result, a, a);
    fp_mont_it_redc(b, result);    
#endif


    
    CNT_FP_SQR_INC();
}


#if defined(P5119m46l244) || defined(P6143m59l262) || defined(P8191m78l338) || defined(P9215m85l389)

void fp_mont_it_redc(fp a, const uint64_t b[2 * NUMBER_OF_WORDS])
{
        uint64_t r0[2 * NUMBER_OF_WORDS] = {0};
        uint64_t r1[2 * NUMBER_OF_WORDS] = {0};

        mult_redc(r0, b, redc_alpha);

        add_redc(r0, &b[E2], r0);
      
        mult_redc(r1, r0, redc_alpha);      

        add_redc_final(a, &r0[E2], r1);
}

#else

/*
    see Algorithm 14.32 "Montgomery reduction"        mult_redc(r0, b, redc_alpha);

        // // r0 = (a− q0)/2^e2 + q0 × alpha
        add_redc(r0, &b[78], r0);

        // // // q0
        // // memcpy(q1, r0, 78 * sizeof(uint64_t));

        mult_redc(r1, r0, redc_alpha);


        add_redc_final(a, &r0[78], r1);

    https://cacr.uwaterloo.ca/hac/about/chap14.pdf
*/
void fp_mont_redc(fp a, const uint64_t b[2 * NUMBER_OF_WORDS])
{

    static __thread uint64_t tp[itch_size];
    uint64_t A[2 * NUMBER_OF_WORDS + 1] = {0x0};
    // uint64_t a_i[1] = {0x0};
    uint64_t tmp_1[NUMBER_OF_WORDS + 1] = {0x0};

    // 1. A = T
    mpn_copyd(A, b, 2 * NUMBER_OF_WORDS);

    for (int i = 0; i < NUMBER_OF_WORDS; i++)
    {
        // 2.1 u_i = a_i * m' mod b
        // since montgomery friendly m' = 1
        // a_i[0] = A[i];

        // 2.2 tmp_1 = u_i * m
        mpn_sec_mul(tmp_1, p, NUMBER_OF_WORDS, &A[i], 1, tp);

        // 2.2 A = A + u_i * m * b^i
        mpn_add(A + i, A + i, 2 * NUMBER_OF_WORDS + 1 - i, tmp_1, NUMBER_OF_WORDS + 1);

    }

    // 3. A = A/b^n
    mpn_copyd(a, A + NUMBER_OF_WORDS, NUMBER_OF_WORDS);

    // 4. If A > m then A = A - m
    mpn_cnd_sub_n(mpn_cmp(a, p, NUMBER_OF_WORDS) > 0, a, a, p, NUMBER_OF_WORDS);
}




#endif

#if defined(P2047m1l226) 

void fp_mont_2k(fp a, const uint64_t b[2 * NUMBER_OF_WORDS])
{

    static __thread uint64_t tp[itch_size];
    uint64_t A[2 * NUMBER_OF_WORDS + 1] = {0x0};
    // uint64_t a_i[1] = {0x0};
    uint64_t tmp_1[NUMBER_OF_WORDS + 1] = {0x0};

    // 1. A = T
    mpn_copyd(A, b, 2 * NUMBER_OF_WORDS);

    for (int i = 0; i < NUMBER_OF_WORDS; i++)
    {

        memset(tmp_1, 0, sizeof(tmp_1));
        // 2.2 tmp_1 = u_i * m
        mpn_sec_mul(tmp_1, redc_alpha, NUMBER_OF_WORDS - 1, A, 1, tp);

        // mpn_sec_mul(tmp_1, p, NUMBER_OF_WORDS, &A[i], 1, tp);

        // mpn_sub(A, A, 1, A, 1);

        // mpn_copyd(A, A + 1, 2 * NUMBER_OF_WORDS - i);

        // 2.2 A = A + u_i * m * b^i
        mpn_add(A, A + 1, 2 * NUMBER_OF_WORDS - i, tmp_1, NUMBER_OF_WORDS);

    }

    // 3. A = A/b^n
    mpn_copyd(a, A, NUMBER_OF_WORDS);

    // 4. If A > m then A = A - m
    mpn_cnd_sub_n(mpn_cmp(a, p, NUMBER_OF_WORDS) > 0, a, a, p, NUMBER_OF_WORDS);
}

#endif

#if defined(P4095m27l262) 

void fp_mont_4k(fp a, const uint64_t b[2 * NUMBER_OF_WORDS])
{

    static __thread uint64_t tp[itch_size];
    uint64_t A[2 * NUMBER_OF_WORDS + 1] = {0x0};
    // uint64_t a_i[1] = {0x0};
    uint64_t tmp_1[NUMBER_OF_WORDS + 1] = {0x0};

    // 1. A = T
    mpn_copyd(A, b, 2 * NUMBER_OF_WORDS);

    for (int i = 0; i < NUMBER_OF_WORDS; i++)
    {
        // 2.1 u_i = a_i * m' mod b
        // since montgomery friendly m' = 1
        // a_i[0] = A[i];

        memset(tmp_1, 0, sizeof(tmp_1));
        // 2.2 tmp_1 = u_i * m
        mpn_sec_mul(tmp_1, redc_alpha, 38, A, 1, tp);

        // mpn_sec_mul(tmp_1, p, NUMBER_OF_WORDS, &A[i], 1, tp);

        mpn_sub(A, A, 1, A, 1);

        mpn_copyd(A, A + 1, NUMBER_OF_WORDS - i);

        // 2.2 A = A + u_i * m * b^i
        mpn_add(A, A, 2 * NUMBER_OF_WORDS + 1 - i, tmp_1, 38);

    }

    // 3. A = A/b^n
    mpn_copyd(a, A, NUMBER_OF_WORDS);

    // 4. If A > m then A = A - m
    mpn_cnd_sub_n(mpn_cmp(a, p, NUMBER_OF_WORDS) > 0, a, a, p, NUMBER_OF_WORDS);
}

#endif
